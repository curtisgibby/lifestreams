const streamMargin=5,streamHeight=50,svgWidth=window.innerWidth-50,height=(streams.length+1)*(streamHeight+streamMargin),svg=d3.select("#svg1").attr("width",svgWidth).attr("height",height).style("background-color","#eee");let startDate=new Date,endDate=Date.parse("1970-01-01");for(const t of streams)for(const e of t.events)eventStartDate=e.startDate||"1970-01-01",e.parsedStartDate=Date.parse(eventStartDate),e.parsedStartDate<startDate&&(startDate=e.parsedStartDate),eventEndDate=e.endDate||(new Date).toLocaleDateString(),e.parsedEndDate=Date.parse(eventEndDate),e.parsedEndDate>endDate&&(endDate=e.parsedEndDate);const timeScale=d3.scaleTime().domain([new Date(startDate),new Date(endDate)]).range([0,svgWidth]),xAxis=d3.axisBottom().scale(timeScale);svg.append("g").call(xAxis);const tooltip=d3.select("body").append("div").style("position","absolute").style("z-index","10").style("visibility","hidden").style("padding",".1rem").style("background","#dddddddd");for(const t of streams){const e=t.index*(streamHeight+streamMargin);for(const a of t.events){let s="";t.label&&(s+="<h4>"+t.label+"</h4>"),a.label&&(s+="<h5>"+a.label+"</h5>"),(a.startDate||a.endDate)&&(s+="<p><i>",a.startDate&&(s+=new Date(a.startDate).toLocaleDateString()),s+="â€“",a.endDate&&(s+=new Date(a.endDate).toLocaleDateString()),s+="</i></p>"),a.imageUrl&&(s+='<img style="max-width: 200px; max-height: 200px;" src="'+a.imageUrl+'">'),svg.append("line").style("stroke",a.color||t.color).style("stroke-width",streamHeight).attr("x1",timeScale(new Date(a.parsedStartDate))).attr("y1",e).attr("x2",timeScale(new Date(a.parsedEndDate))).attr("y2",e).attr("data-html",s).on("mouseover",function(t){tooltip.html(t.target.getAttribute("data-html")).style("visibility","visible").style("left",t.clientX+"px").style("top",t.clientY-28+"px")}).on("mouseout",function(t){tooltip.style("visibility","hidden")})}}